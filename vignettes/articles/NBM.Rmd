---
title: "National Broadband Map (NBM)"
output: rmarkdown::html_vignette
code_folding: hide
vignette: >
  %\VignetteIndexEntry{National Broadband Map (NBM)}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(DT)
table_with_options <- function(x){DT::datatable(x, rownames = FALSE,
              extensions = 'Buttons',
                options = list(
                          dom = 'Blfrtip',
                          buttons = list('copy', 'print', list(
                            extend = 'collection',
                            buttons = c('csv', 'excel'),
                            text = 'Download')
                                    )
                          )
            )}
```

```{r setup}
library(cori.data.fcc)
```

# What is the National Broadband Map (NBM) data set?

## License and Attribution

The license can be found [here](https://broadbandmap.fcc.gov/about):

> Broadband availability data from the BDC, and data from the U.S. Census Bureau that are presented on this site, are offered free and not subject to copyright restriction. Data and content created by government employees within the scope of their employment are not subject to domestic copyright protection under 17 U.S.C. § 105. See, e.g., [U.S. Government Works](https://www.usa.gov/government-copyright).
>
> While not required, when using in your own work content, data, documentation, code, and related materials from fcc.gov or broadbandmap.fcc.gov, we ask that you provide proper attribution of the data. Examples include:
>
>    Source data: FCC Broadband Data Collection
>    Map layer based on FCC BDC
>
> CostQuest Associates, Inc. and its third-party licensors, as applicable, own all right, title, and interest, including all intellectual property rights, in and to the data for locations reflected in the Fabric (including the Location ID, latitude and longitude, address, unit count, and building type code for each location in the Fabric). CostQuest is granted certain rights to Fabric correction submissions for the purpose of correcting or otherwise modifying BDC Fabric data. Broadband service providers, governmental entities, and other third parties are able to license Fabric data, including any changes to Fabric data that have been made as a result of challenges, at no cost for purposes of their participation in the FCC's Broadband Data Collection.


## A Quick Introduction 

NBM was started by the FCC in November 2022[^fcc_nbm_start] and is following [Form 477](https://ruralinnovation.github.io/cori.data.fcc/articles/f477.html). 

[^fcc_nbm_start]: [https://www.fcc.gov/news-events/notes/2022/11/18/new-broadband-maps-are-finally-here](https://www.fcc.gov/news-events/notes/2022/11/18/new-broadband-maps-are-finally-here)

Behind the National Broadband Map they are **two** datasets (see @fig-broadbanddata, below). 
We are using the "Broadband Availability" dataset that is derived from the "Fabric" locations dataset (developed by CostQuest). 
The locations are determined within the Fabric locations data. 

This dataset can be derived in multiple ways: by States or by Providers.  

At the States the Data can be split between summaries and "raw data".
The summaries available are by geographies or by technologies: Fixed Broadband and Mobile Broadband.

For every states you need to access the raw data by technologies. 
In our works we focused in the Fixed Broadband Availability Data. 

Here, the NBM provides information at the scale of a "service" - a location covered by a provider by a technology with specifics maximum speeds.

This is one of the big change versus Form 477: we are moving from the scale of a Census block to the scale of a location (See @sec-BSL for a definition). 

Every location is characterized by:

- Who is providing those services (`frn`, `provider_id`, and `brand_name`)
- A description of each services (`technology`, `max_advertised_download_speed`, `max_advertised_upload_speed`, `low_latency`)
- Whether the location associated with residential, business or both
- ways to localize it (`state_abbr`, `block_geoid`, `h3_res8_id`)

In our ingestion we did not kept `h3_res8_id` but we added the date of the release and the timestamp provided in the filename (see `data-raw/NBM.R` to get every details).

The exact coordinates of every locations is only part of the Fabric dataset and within the Broadband Availability we can only link a record for a location to a Census Block (2020 vintage) or H3 hexagon.

!["What is on the national broadband map" Source: [https://www.fcc.gov/BroadbandData](https://www.fcc.gov/BroadbandData)](whats-on-the-national-broadband-map-113023-1.png){#fig-broadbanddata}

### What is a Broadband Service Location (BSL)? {#sec-BSL}

> A broadband serviceable location is defined as “a business or residential location in the United States at which fixed broadband Internet access service is, or can be, installed.” 
A residential BSL includes all residential structures, including structures that are (or contain) housing units or group quarters (as those terms are defined by the United States Census Bureau).  
A business BSL includes “all non-residential (business, government, non-profit, etc.) structures that are on property without residential locations and that would expect to demand Internet access service.” (source FCC[^fcc_bsl])

[^fcc_bsl]: ["The Fabric data"](https://help.bdc.fcc.gov/hc/en-us/articles/7412732399003-Fabric-FAQs)

### When is this data updated?

NBM has two big releases per year (June and December) and have versions every two weeks to take into account challenges[^challenges]. 
Experience has told us that sometimes their release can be faster (more than one per week) or slower.
The FCC did not (April 2024) provides a changelog between releases or versions (but the documentation has some of the major changes[^nbm_chnagelog]). 

[^challenges]: [https://www.fcc.gov/sites/default/files/bdc-challenge-overview.pdf](https://www.fcc.gov/sites/default/files/bdc-challenge-overview.pdf)

[^nbm_chnagelog]:See "Change Log" [https://us-fcc.app.box.com/v/bdc-data-downloads-output](https://us-fcc.app.box.com/v/bdc-data-downloads-output)


### What is the geographic coverage?

The Broadband Availability data is covering all US States, Puerto Rico and the US territories.  


# How does cori.data.fcc help me getting NBM data? 

`cori.data.fcc` help you access this data set in 3 diffferent ways: 

1. The package is providing functions to list available data and download it 

2. We ingested all the Fixed Broadband Availability Data and are providing it in a s3 bucket

3. We ingested all Fixed Broadband Availability data and transformed it to provides information at the Census block level.


## Which ways should I go? 

It will depends on your specific needs. 
We were more interested at the information at the census block level but for that we needed to download the data. 
So we might as well share how we do it.
We then first transformed the data in our database. 
The process was taking some time and frequently we had questions that could not be answered with how the schema was made, hence we reingested it. 
Ingesting CSV is a coastly operation it was better to have an intermediary data set, close to the raw data but in a better format to either access it and or reingest it. 
Parquet was perfect for that need and we might as well provide other to access it. 


### NBM raws's Data dictionary 

This dataset is called "nbm_raw" and  dictionary can be accessed with the function `get_fcc_dictionary`:

```{r nbm-data-dic}
table_with_options(get_fcc_dictionary("nbm_raw"))
```


### NBM Block's Data Dictionary

This dataset is called "nbm_block"

```{r nbm-data-dic2}
table_with_options(get_fcc_dictionary("nbm_block"))
```


<!--
## What is unserved v.s. underseved?

Served, Unserved and Underseved are **overlapping** categories at the **location level**. They can be extended at the "**area level**".

If all available internet services at a location have advertised (reported) maximum speeds that are below 25 Mbps downstream speed or below 3 Mbps upstream (25/3 to simplify), then that location is categorized as **unserved**. If a location has at least one service with maximum speeds that are equal to or above 25/3, but no service with maximum speeds that are equal to or above 100/20, it is categorized as **underserved**. If a location has at least one service with maximum speeds that are equal to or above 100/20, then that location is categorized as **served**.

Those definitions are recommended in the [FCC's Broadband Speed Benchmark](https://www.fcc.gov/document/fcc-increases-broadband-speed-benchmark) and can be adapted by every States[^pew_list].

[^pew_list]: Page 4 [https://www.pewtrusts.org/-/media/assets/2023/06/un--and-underserved-definitions-ta-memo-pdf.pdf](https://www.pewtrusts.org/-/media/assets/2023/06/un--and-underserved-definitions-ta-memo-pdf.pdf)

:::{.aside}
FCC could change those definitions and for example move the bar at 100/20: [https://www.fcc.gov/document/fcc-increases-broadband-speed-benchmark](https://www.fcc.gov/document/fcc-increases-broadband-speed-benchmark)
:::
-->




